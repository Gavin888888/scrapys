# -*- coding: utf-8 -*-import scrapyimport sqlite3from ..items import NationalDetailItemclass NationalFlagSpider(scrapy.Spider):    # 连接数据库    con = sqlite3.connect('national.sqlite')    cu = con.cursor()    search_sql = "select * from nationals"    model = cu.execute(search_sql)    start_urls = []    for a in model:        national_detail_url = "http://country.911cha.com/{}".format(a[1])        start_urls.append(national_detail_url)    # name = 'national_flag'    # allowed_domains = ['country.911cha.com']    # start_urls = ['http://country.911cha.com/']    # def parse(self, response):    #     item = NationalFlagItem()    #     hrefs = response.xpath(".//div[@class='mcon']/ul/li/a/@href").extract()    #     nationals = response.xpath(".//div[@class='mcon']/ul/li/a/text()").extract()    #     for a,b in zip(nationals,hrefs):    #         print(a+"\t"+b+"\n")    #         item['national'] = a    #         item['national_href'] = b    #         yield item    name = 'national_detail'    allowed_domains = ['country.911cha.com']    # print(start_urls)    # start_urls = ['http://country.911cha.com/SEN.html']    def parse(self, response):        item = NationalDetailItem()        nationals = response.xpath(".//*[@id='mainbox']/div[1]/div[2]/div[2]/p[1]/strong/font/text()").extract()[0]        print(nationals)        national_alls = response.xpath(".//*[@id='mainbox']/div[1]/div[2]/div[2]/p[2]/text()").extract()[0]        print(national_alls)        states = response.xpath(".//*[@id='mainbox']/div[1]/div[2]/div[2]/p[2]/a/text()").extract()[0]        print(states)        capitals = response.xpath(".//*[@id='mainbox']/div[1]/div[2]/div[2]/p[2]/strong[1]/text()").extract()[0]        print(capitals)        languages = response.xpath(".//*[@id='mainbox']/div[1]/div[2]/div[2]/p[2]/strong[2]/text()").extract()[0]        print(languages)        areas = response.xpath(".//*[@id='mainbox']/div[1]/div[2]/div[2]/p[2]/strong[3]/text()").extract()[0]        print(areas)        currencys = response.xpath(".//*[@id='mainbox']/div[1]/div[2]/div[2]/p[3]/strong[1]/text()").extract()[0]        print(currencys)        area_codes = response.xpath(".//*[@id='mainbox']/div[1]/div[2]/div[2]/p[3]/strong[2]/text()").extract()[0]        print(area_codes)        general_situations = response.xpath(".//*[@id='mainbox']/div[1]/div[2]/div[4]/p[2]/text()").extract()[0]        print(general_situations)        # general_situations_divs = response.xpath(".//*[@id='mainbox']/div[1]/div[2]/div[4]/div[1]")        # general_situations = ""        # for p in general_situations_divs.xpath('.//p/text()'):        #     general_situations = general_situations + p.extract().strip()        # print(general_situations)        nation_flag_img_urls = response.xpath(".//*[@id='mainbox']/div[1]/div[2]/div[2]/p[1]/img/@src").extract()[0]        nation_flag_img_url = "http://country.911cha.com/{}".format(nation_flag_img_urls)        print(nation_flag_img_url)        item['national'] = nationals        new_national_all = national_alls.replace(' ', '')        new_national_all1 = new_national_all.replace('，', '')        item['national_all'] = new_national_all1        item['state'] = states        item['capital'] = capitals        item['language'] = languages        if areas:            item['area'] = areas        item['currency'] = currencys        item['area_code'] = area_codes        item['general_situation'] = general_situations        item['nation_flag_img_url'] = nation_flag_img_url        item['nation_flag_img_path'] = ''        yield item